# Simple Agentic RAG

This project uses synthetic university course data generated by an LLM to demonstrate how to apply RAG for course information retrieval.

## 1. Preparation

LangChain and LangGraph as the core frameworks to define agent logic and graph-based execution.

Milvus as the vector database for semantic search and document retrieval.

Ollama as the local LLM runtime for fast, offline model inference.

### (1) Install Ollama
```bash
curl -fsSL https://ollama.com/install.sh | sh
```
[Download Ollama](https://ollama.com/download/linux)


### (2) Install Milvus vector database
```bash
curl -sfL https://raw.githubusercontent.com/milvus-io/milvus/master/scripts/standalone_embed.sh -o standalone_embed.sh

bash standalone_embed.sh start
```
[Install Milvus by docker](https://milvus.io/docs/zh-hant/install_standalone-docker.md)


### (3) Install Milvus UI attu
```bash
docker run --name milvus_attu --network host -e MILVUS_URL=localhost:19530 zilliz/attu:v2.5
```
[zilliztech/attu quick start](https://github.com/zilliztech/attu?tab=readme-ov-file#quick-start)


## 2. Agentic RAG preparation for this project

### (1) Initilization
Please make sure you are on a **conda environment** or **python virtual environment** before execution.
```bash
# pull ollama models
ollama pull qwen3:1.7b
ollama pull qllama/multilingual-e5-base:latest

# install pip packages
pip install -r requirements.txt

# check text embedder first
export TEXT_EMBEDDER_URL="http://localhost:11434/api/embed"
export TEXT_EMBEDDER_MODEL="qllama/multilingual-e5-base:latest"
python -m tools.text_embedder

# convert excel file into vector data and store into milvus db
python -m course_agent.convert_excel_to_vector --db_host localhost --db_port 19530
```

### (2) Execution
Please make sure you are on a **conda environment** or **python virtual environment** before execution.

* for workflow built by langgraph prebuild function create_react_agent()
```bash
python -m course_agent.vector_agent --db_uri "http://localhost:19530" --ollama_uri "http://localhost:11434" --ollama_model "qwen3:1.7b"
```

* for custom workflow

separate the llm db agent and the final llm for generation(generator), can set db agent with smaller llm like qwen3:1.7b and set generator with bigger llm like llama3.3:70b for better responsing like formatting or multilingual

```bash
python -m course_agent.vector_agent_graph --db_uri "http://localhost:19530" --ollama_uri "http://localhost:11434" --llm_db_agent "qwen3:1.7b" --llm_generator "qwen3:1.7b"
```

* for web api server starting
```bash
python -m course_agent.web_api_server --host 0.0.0.0 --port 20000 --db_uri "http://localhost:19530" --ollama_uri "http://localhost:11434"
```

* for request to web api server
```bash
curl --location 'http://localhost:20000/course/search' \
--header 'Content-Type: application/json' \
--data '{
    "input": "Recommend a course that can improve my android development skills.",
    "model": "qwen3:1.7b"
}'
```

## Available tools for course agent

MCP server is at course_agent/milvus_mcp_server.py

1. Tool to search course name by key word query
```python
def search_by_course_name(query: str) -> str
```

2. Tool to search course time by key word query
```python
def search_by_course_time(query: str) -> str
```

3. Tool to search course detail description by key word query
```python
def search_by_description(query: str) -> str
```


## Testing

Tested by ollama model: qwen3:1.7b

(1) User's input:

```
Recommend a NCHU course that can improve my android development skills.
```

(2) LLM tool_calls: 
```json
[
    {
        "name": "search_by_description",
        "args": {
            "query": "Android development"
        },
        "id": "tool-0",
        "type": "tool_call"
    }
]
```

(3) Tool message: 
```
Course 'Mobile App Development' at time 'Fri 10:00~13:00' with detailed information: Focuses on designing and building Android and iOS apps using modern development tools and frameworks.
...
```

(4) LLM final response:
```
Based on your goal to enhance Android development skills, the **"Mobile App Development"** course is the most suitable recommendation.
...
```

## Reference

This project references parts of the original structure from [NVIDIA-AI-IOT/remembr](https://github.com/NVIDIA-AI-IOT/remembr). Licensed under the NVIDIA Source Code License (non-commercial use only)